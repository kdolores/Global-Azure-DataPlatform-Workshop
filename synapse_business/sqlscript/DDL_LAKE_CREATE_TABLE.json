{
	"name": "DDL_LAKE_CREATE_TABLE",
	"properties": {
		"content": {
			"query": "CREATE DATABASE gab2023lake;\nGO\n\nUSE gab2023lake;\nGO\n\n-----------------------------------------------------\n---Business Table Creation\n-----------------------------------------------------\nCREATE EXTERNAL TABLE bdv.comercial_city(\n    [CityKey] [int],\n\t[WWICityID] [int],\n\t[City] [nvarchar](50),\n\t[StateProvince] [nvarchar](50),\n\t[Country] [nvarchar](60),\n\t[Continent] [nvarchar](30),\n\t[SalesTerritory] [nvarchar](50),\n\t[Region] [nvarchar](30),\n\t[Subregion] [nvarchar](30),\n\t[LatestRecordedPopulation] [bigint],\n\t[ValidFrom] [datetime2](7),\n\t[ValidTo] [datetime2](7),\n\t[LineageKey] [int]\n) WITH (\n    LOCATION = '/data/city/city.parquet',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = UPParquetFileFormat\n);\nGO\n\n------------------------------------------------------------------------\nCREATE EXTERNAL TABLE bdv.d365fop_movement(\n\t[MovementKey] [bigint],\n\t[DateKey] [date],\n\t[StockItemKey] [int],\n\t[CustomerKey] [int],\n\t[SupplierKey] [int],\n\t[TransactionTypeKey] [int],\n\t[WWIStockItemTransactionID] [int],\n\t[WWIInvoiceID] [int],\n\t[WWIPurchaseOrderID] [int],\n\t[Quantity] [int],\n\t[LineageKey] [int],\n\t[year] [nvarchar](4),\n\t[month] [nvarchar](2),\n\t[day] [nvarchar] (2)\n) WITH (\n    LOCATION = '/data/movement/year=*/month=*/day=*/*.parquet',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = UPParquetFileFormat\n);\nGO\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\nCREATE EXTERNAL TABLE rdv.d365fop_customer (\n    [CustomerKey] [int] NOT NULL,\n\t[WWICustomerID] [int] NOT NULL,\n\t[Customer] [nvarchar](100) NOT NULL,\n\t[BillToCustomer] [nvarchar](100) NOT NULL,\n\t[Category] [nvarchar](50) NOT NULL,\n\t[BuyingGroup] [nvarchar](50) NOT NULL,\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\n\t[PostalCode] [nvarchar](10) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n) WITH (\n    LOCATION = '/data/customer/',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = LKDeltaFileFormat\n);\n\nCREATE EXTERNAL TABLE rdv.d365fop_employee (\n    [EmployeeKey] [int] NOT NULL,\n\t[WWIEmployeeID] [int] NOT NULL,\n\t[Employee] [nvarchar](50) NOT NULL,\n\t[PreferredName] [nvarchar](50) NOT NULL,\n\t[IsSalesperson] [bit] NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n) WITH (\n    LOCATION = '/data/employee/',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = LKDeltaFileFormat\n);\n\nCREATE EXTERNAL TABLE rdv.d365fop_paymentmethod (\n\t[PaymentMethodKey] [int] NOT NULL,\n\t[WWIPaymentMethodID] [int] NOT NULL,\n\t[PaymentMethod] [nvarchar](50) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n) WITH (\n    LOCATION = '/data/paymentmethod/',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = LKDeltaFileFormat\n);\n\nCREATE EXTERNAL TABLE rdv.d365fop_stockitem (\n\t[StockItemKey] [int] NOT NULL,\n\t[WWIStockItemID] [int] NOT NULL,\n\t[Stock Item] [nvarchar](100) NOT NULL,\n\t[Color] [nvarchar](20) NOT NULL,\n\t[SellingPackage] [nvarchar](50) NOT NULL,\n\t[Buying Package] [nvarchar](50) NOT NULL,\n\t[Brand] [nvarchar](50) NOT NULL,\n\t[Size] [nvarchar](20) NOT NULL,\n\t[LeadTimeDays] [int] NOT NULL,\n\t[QuantityPerOuter] [int] NOT NULL,\n\t[IsChillerStock] [bit] NOT NULL,\n\t[Barcode] [nvarchar](50) NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[RecommendedRetailPrice] [decimal](18, 2) NULL,\n\t[TypicalWeightPerUnit] [decimal](18, 3) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n) WITH (\n    LOCATION = '/data/sotckitem/',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = LKDeltaFileFormat\n);\n\nCREATE EXTERNAL TABLE rdv.d365fop_supplier (\n    [SupplierKey] [int] NOT NULL,\n\t[WWISupplierID] [int] NOT NULL,\n\t[Supplier] [nvarchar](100) NOT NULL,\n\t[Category] [nvarchar](50) NOT NULL,\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\n\t[SupplierReference] [nvarchar](20) NULL,\n\t[PaymentDays] [int] NOT NULL,\n\t[PostalCode] [nvarchar](10) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n) WITH (\n    LOCATION = '/data/supplier/',\n    DATA_SOURCE = ExternalRDVDataSource,\n    FILE_FORMAT = LKDeltaFileFormat\n);\n\n\n\n\n\n\n\n\n\n\n-----------------------------------------------------",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}